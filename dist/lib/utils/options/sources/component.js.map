{"version":3,"file":"component.js","sourceRoot":"","sources":["../../../../../src/lib/utils/options/sources/component.ts"],"names":[],"mappings":";;;;;;;;AAAA,+CAAmG;AACnG,wCAA8C;AAG9C,IAAa,eAAe,GAA5B,MAAa,eAAgB,SAAQ,0BAAgB;IAGvC,UAAU;QAChB,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;QAC1B,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAEpC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,EAAE;YAC5B,CAAC,0BAAc,CAAC,KAAK,CAAC,EAAI,IAAI,CAAC,gBAAgB;YAC/C,CAAC,0BAAc,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,kBAAkB;SACpD,CAAC,CAAC;IACP,CAAC;IAEO,YAAY,CAAC,SAAiC;QAClD,MAAM,IAAI,GAAG,SAAS,CAAC,aAAa,CAAC;QACrC,IAAI,CAAC,IAAI,EAAE;YACP,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,KAAK,CAAC,+BAA+B,CAAC,CAAC;YAC/D,OAAO;SACV;QAED,IAAI,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;YAC3C,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,CAAC,eAAe,CAAC,SAAS,CAAC,qBAAqB,EAAE,CAAC,CAAC;SACjE;QAED,IAAI,SAAS,YAAY,8BAAkB,EAAE;YACzC,KAAK,IAAI,KAAK,IAAI,SAAS,CAAC,aAAa,EAAE,EAAE;gBACzC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;aAC5B;SACJ;IACL,CAAC;IAEO,eAAe,CAAC,SAAiC;QACrD,IAAI,KAAK,GAAG,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAClE,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE;YACd,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YACtC,KAAK,IAAI,WAAW,IAAI,SAAS,CAAC,qBAAqB,EAAE,EAAE;gBACvD,IAAI,CAAC,KAAK,CAAC,uBAAuB,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC;aACxD;SACJ;QAED,IAAI,SAAS,YAAY,8BAAkB,EAAE;YACzC,KAAK,IAAI,KAAK,IAAI,SAAS,CAAC,aAAa,EAAE,EAAE;gBACzC,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;aAC/B;SACJ;IACL,CAAC;IAEO,gBAAgB,CAAC,CAAiB;QACtC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IACnC,CAAC;IAEO,kBAAkB,CAAC,CAAiB;QACxC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC;IACtC,CAAC;CACJ,CAAA;AAvDY,eAAe;IAD3B,qBAAS,CAAC,EAAC,IAAI,EAAE,mBAAmB,EAAC,CAAC;GAC1B,eAAe,CAuD3B;AAvDY,0CAAe","sourcesContent":["import { Component, ComponentEvent, AbstractComponent, ChildableComponent } from '../../component';\r\nimport { OptionsComponent } from '../options';\r\n\r\n@Component({name: 'options:component'})\r\nexport class ComponentSource extends OptionsComponent {\r\n    private knownComponents!: string[];\r\n\r\n    protected initialize() {\r\n        this.knownComponents = [];\r\n        this.addComponent(this.application);\r\n\r\n        this.listenTo(this.application, {\r\n            [ComponentEvent.ADDED]:   this.onComponentAdded,\r\n            [ComponentEvent.REMOVED]: this.onComponentRemoved\r\n        });\r\n    }\r\n\r\n    private addComponent(component: AbstractComponent<any>) {\r\n        const name = component.componentName;\r\n        if (!name) {\r\n            this.application.logger.error('Component without name found.');\r\n            return;\r\n        }\r\n\r\n        if (this.knownComponents.indexOf(name) === -1) {\r\n            this.knownComponents.push(name);\r\n            this.owner.addDeclarations(component.getOptionDeclarations());\r\n        }\r\n\r\n        if (component instanceof ChildableComponent) {\r\n            for (let child of component.getComponents()) {\r\n                this.addComponent(child);\r\n            }\r\n        }\r\n    }\r\n\r\n    private removeComponent(component: AbstractComponent<any>) {\r\n        let index = this.knownComponents.indexOf(component.componentName);\r\n        if (index !== -1) {\r\n            this.knownComponents.splice(index, 1);\r\n            for (let declaration of component.getOptionDeclarations()) {\r\n                this.owner.removeDeclarationByName(declaration.name);\r\n            }\r\n        }\r\n\r\n        if (component instanceof ChildableComponent) {\r\n            for (let child of component.getComponents()) {\r\n                this.removeComponent(child);\r\n            }\r\n        }\r\n    }\r\n\r\n    private onComponentAdded(e: ComponentEvent) {\r\n        this.addComponent(e.component);\r\n    }\r\n\r\n    private onComponentRemoved(e: ComponentEvent) {\r\n        this.removeComponent(e.component);\r\n    }\r\n}\r\n"]}